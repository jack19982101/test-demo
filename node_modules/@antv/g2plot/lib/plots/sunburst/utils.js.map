{"version":3,"file":"utils.js","sourceRoot":"","sources":["../../../src/plots/sunburst/utils.ts"],"names":[],"mappings":";;;;AAAA,oEAAqC;AAGrC;;;GAGG;AACH,SAAgB,aAAa,CAAC,OAAwB;IAC5C,IAAA,IAAI,GAAqD,OAAO,KAA5D,EAAE,IAAI,GAA+C,OAAO,KAAtD,EAAE,WAAW,GAAkC,OAAO,YAAzC,EAAE,UAAU,GAAsB,OAAO,WAA7B,EAAE,eAAe,GAAK,OAAO,gBAAZ,CAAa;IACjE,IAAA,QAAQ,GAAK,kBAAO,SAAZ,CAAa;IAC7B,IAAM,EAAE,GAAG,IAAI,QAAQ,EAAE,CAAC;IAC1B,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE;QACd,IAAI,EAAE,WAAW;KAClB,CAAC,CAAC,SAAS,uCACP,eAAe;QAClB,aAAa;QACb,IAAI,EAAE,eAAa,IAAM,EACzB,KAAK,EAAE,WAAW,EAClB,EAAE,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,IACd,CAAC;IACH,IAAM,KAAK,GAAG,EAAE,CAAC,WAAW,EAAE,CAAC;IAC/B,IAAM,MAAM,GAAG,EAAE,CAAC;IAClB,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;;;QACjB,IAAI,IAAI,CAAC,KAAK,KAAK,CAAC,EAAE;YACpB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,QAAQ,iCACX,WAAW,UAAG,IAAI,CAAC,IAAI,0CAAG,WAAW,MACrC,UAAU,UAAG,IAAI,CAAC,IAAI,0CAAG,UAAU,QACjC,IAAI,CACR,CAAC;QACF,QAAQ,CAAC,GAAG,GAAG,eAAe,CAAC;QAC/B,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,MAAM,EAAE;YACnC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;SACzC;aAAM;YACL,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;SAClC;QAED,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACxB,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AAChB,CAAC;AAnCD,sCAmCC","sourcesContent":["import DataSet from '@antv/data-set';\nimport { SunburstOptions } from './types';\n\n/**\n * sunburst 处理数据\n * @param options\n */\nexport function transformData(options: SunburstOptions) {\n  const { data, type, seriesField, colorField, hierarchyConfig } = options;\n  const { DataView } = DataSet;\n  const dv = new DataView();\n  dv.source(data, {\n    type: 'hierarchy',\n  }).transform({\n    ...hierarchyConfig,\n    // @ts-ignore\n    type: `hierarchy.${type}`,\n    field: seriesField,\n    as: ['x', 'y'],\n  });\n  const nodes = dv.getAllNodes();\n  const result = [];\n  nodes.forEach((node) => {\n    if (node.depth === 0) {\n      return null;\n    }\n    const nodeInfo = {\n      [seriesField]: node.data?.[seriesField],\n      [colorField]: node.data?.[colorField],\n      ...node,\n    };\n    nodeInfo.ext = hierarchyConfig;\n    if (!node.data.brand && node.parent) {\n      nodeInfo.brand = node.parent.data.brand;\n    } else {\n      nodeInfo.brand = node.data.brand;\n    }\n\n    result.push(nodeInfo);\n  });\n\n  return result;\n}\n"]}